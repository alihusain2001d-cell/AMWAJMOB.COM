<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8" />
<title>تحقق من الضمان</title>

<style>
body {font-family: Tahoma; background:#f4f6fa; text-align:center;}
.box{background:#fff;padding:20px;margin:40px auto;border-radius:10px;width:90%;max-width:450px;
box-shadow:0 3px 10px rgba(0,0,0,.1);}
input{padding:10px;width:90%;margin-top:10px}
button{padding:10px 18px;margin-top:10px;background:#2196F3;color:#fff;border:0;border-radius:6px}
.result{margin-top:15px;text-align:right}
</style>
</head>

<body>

<div class="box">
  <h2>تحقق من الضمان</h2>

  <input id="inv" placeholder="أدخل رقم الفاتورة">
  <br>
  <button onclick="check()">بحث</button>

  <div id="out" class="result"></div>
</div>

<script>
const SHEET =
 "https://docs.google.com/spreadsheets/d/e/2PACX-1vTraFUR-pqdM1dR-syL2zyxSNuQvDhNRnk95BkjBecronw6tB0jvAISLAMRuZpTIrLSp2DkeX-ElqUQ/pub?output=csv";

async function check() {
  let v = document.getElementById("inv").value.trim();
  if (!v) return alert("ادخل رقم الفاتورة");

  let res = await fetch(SHEET);
  let text = await res.text();

  // نحول CSV إلى مصفوفة
  let rows = text.split("\n").map(r => r.split(","));

  // نبحث بالفاتورة (العمود الأول)
  let found = rows.find(r => String(r[0]).trim() === v);

  if (!found) {
    document.getElementById("out").innerHTML =
      "<b>❌ لم يتم العثور على رقم الفاتورة</b>";
  } else {
    document.getElementById("out").innerHTML =
      `<b>✔️ تم العثور على الضمان</b><br>
       الاسم: ${found[1]}<br>
       الهاتف: ${found[2]}<br>
       النوع: ${found[3]}<br>
       تاريخ البدء: ${found[4]}<br>
       الانتهاء: ${found[5]}`;
  }
}
</script>
