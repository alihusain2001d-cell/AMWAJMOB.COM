<!DOCTYPE html>
<html lang="ar">
<head>
<meta charset="UTF-8">
<title>تفعيل ضمان أمواج</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<style>
body{font-family:sans-serif;padding:15px}
label{font-weight:bold}
input,select,button{width:100%;padding:8px;margin:6px 0 15px}
button{background:#1e88e5;color:#fff;border:none;border-radius:6px}
#result,#timer{background:#f4f6fb;padding:10px;border-radius:8px;margin-top:10px}
</style>
</head>

<body>

<h3>تفعيل ضمان أمواج للإلكترونيات</h3>
<p>الرجاء إدخال البيانات لتفعيل الضمان:</p>

<label>اسم الزبون</label>
<input id="name" type="text">

<label>رقم الهاتف</label>
<input id="phone" type="text">

<label>رقم الفاتورة</label>
<input id="invoice" type="text">

<label>نوع القطعة</label>
<select id="type">
  <option value="screen">شاشة</option>
  <option value="battery">بطارية</option>
</select>

<label>تاريخ التركيب</label>
<input id="start" type="date">

<button onclick="sendData()">تفعيل الضمان</button>

<div id="result"></div>
<div id="timer"></div>

<script>
function sendData(){

  const data = {
    name: document.getElementById("name").value.trim(),
    phone: document.getElementById("phone").value.trim(),
    invoice: document.getElementById("invoice").value.trim(),
    type: document.getElementById("type").value,
    start: document.getElementById("start").value
  };

  if(!data.name || !data.phone || !data.invoice || !data.start){
    alert("الرجاء إدخال جميع الحقول");
    return;
  }

  fetch("https://eo9txe5hkh3d1yk.m.pipedream.net",{
    method:"POST",
    headers:{ "Content-Type":"application/json" },
    body:JSON.stringify(data)
  })
  .then(() => {

    const startDate = new Date(data.start);
    let expiryDate = new Date(startDate);

    // شهر للشاشة — سنة للبطارية
    if(data.type === "screen"){
      expiryDate.setMonth(expiryDate.getMonth() + 1);
    } else {
      expiryDate.setFullYear(expiryDate.getFullYear() + 1);
    }

    document.getElementById("result").innerHTML =
      `تم تفعيل الضمان بتاريخ: <b>${startDate.toLocaleDateString()}</b><br>
       تاريخ انتهاء الضمان: <b>${expiryDate.toLocaleDateString()}</b><br><br>
       ⭐ شكراً لاختياركم <b>أمواج للإلكترونيات</b> ⭐`;

    startCountdown(expiryDate);
  })
  .catch(() => alert("حدث خطأ — حاول مرة أخرى"));
}

function startCountdown(expiryDate){
  const timer = document.getElementById("timer");

  setInterval(() => {
    const now = new Date();
    const diff = expiryDate - now;

    if(diff <= 0){
      timer.innerHTML = "انتهى الضمان";
      return;
    }

    const days = Math.floor(diff / (1000*60*60*24));
    const hours = Math.floor((diff / (1000*60*60)) % 24);
    const minutes = Math.floor((diff / (1000*60)) % 60);
    const seconds = Math.floor((diff / 1000) % 60);

    timer.innerHTML = `⏳ الوقت المتبقي: ${days} يوم — ${hours}:${minutes}:${seconds}`;
  },1000);
}
</script>

</body>
</html>
