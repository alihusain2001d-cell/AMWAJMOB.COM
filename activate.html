<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8" />
<title>Ù†Ø¸Ø§Ù… Ø¶Ù…Ø§Ù† Ø£Ù…ÙˆØ§Ø¬</title>
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

<style>
body{
  font-family:sans-serif;
  padding:18px;
  background:linear-gradient(135deg,#e6f6ff,#cfefff,#e6f6ff);
}
.container{
  max-width:580px;
  margin:auto;
  background:#fff;
  padding:18px;
  border-radius:16px;
  box-shadow:0 12px 28px rgba(0,0,0,.08);
}
.logo{text-align:center;margin-bottom:12px}
.logo img{width:140px}

.bigbtn{
  width:100%;
  padding:14px;
  border-radius:12px;
  border:0;
  margin:8px 0;
  font-size:20px;
  font-weight:bold;
  cursor:pointer;
}
.big1{background:#1e88e5;color:#fff}
.big2{background:#6c7d90;color:#fff}

label{font-weight:bold;font-size:14px}
input,select,button{
  width:100%;
  padding:6px;
  margin:6px 0 14px;
  border-radius:10px;
  border:1px solid #ccd6e6;
  font-size:14px;
}
button{background:#1e88e5;color:#fff;border:none}

.result{
  background:#e8f4ff;
  padding:12px;
  border-radius:10px;
  display:none;
}
.msg-err{
  display:none;
  background:#fde7e7;
  color:#b10606;
  border:1px solid #f3bcbc;
  padding:10px;
  border-radius:10px;
  margin:10px 0;
  font-weight:bold;
}

/* ===== Ø£Ø³Ø¹Ø§Ø± Ø§Ù„Ø´Ø§Ø´Ø§Øª ===== */
.brands-grid{
  display:grid;
  grid-template-columns:repeat(2,1fr);
  gap:10px;
  margin:15px 0;
}
.brand{
  background:#eef4fb;
  border-radius:12px;
  padding:14px 10px;
  text-align:center;
  font-weight:bold;
  cursor:pointer;
}
.brand small{
  display:block;
  color:#555;
  font-weight:normal;
  margin-top:4px;
}
.price-card{
  background:#fff;
  border-radius:12px;
  padding:12px;
  margin-bottom:10px;
  box-shadow:0 2px 6px rgba(0,0,0,.1);
}
.price{color:#1e88e5;font-weight:bold}
.unavailable{color:#c00;font-weight:bold}
</style>
</head>

<body>

<div class="container">

<div class="logo">
  <img src="1633875906547.jpg">
</div>

<!-- Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ© -->
<div id="home">
  <button class="bigbtn big1" onclick="openAct()">ØªÙØ¹ÙŠÙ„ Ø§Ù„Ø¶Ù…Ø§Ù†</button>
  <button class="bigbtn big2" onclick="openChk()">Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ø¶Ù…Ø§Ù†</button>
  <button class="bigbtn big1" onclick="openPrices()">Ø£Ø³Ø¹Ø§Ø± Ø§Ù„Ø´Ø§Ø´Ø§Øª</button>
</div>

<!-- Ø§Ù„ØªÙØ¹ÙŠÙ„ -->
<div id="activate" style="display:none">
  <button onclick="backHome()" class="bigbtn big2">â¬… Ø±Ø¬ÙˆØ¹</button>
  <h3>ØªÙØ¹ÙŠÙ„ Ø¶Ù…Ø§Ù† Ø£Ù…ÙˆØ§Ø¬</h3>

  <label>Ø§Ø³Ù… Ø§Ù„Ø²Ø¨ÙˆÙ†</label>
  <input id="name">

  <label>Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ</label>
  <input id="phone">

  <label>Ø±Ù‚Ù… Ø§Ù„ÙØ§ØªÙˆØ±Ø©</label>
  <input id="invoice">

  <label>Ù†ÙˆØ¹ Ø§Ù„Ù‚Ø·Ø¹Ø©</label>
  <select id="type">
    <option value="screen">Ø´Ø§Ø´Ø©</option>
    <option value="battery">Ø¨Ø·Ø§Ø±ÙŠØ©</option>
  </select>

  <label>ØªØ§Ø±ÙŠØ® Ø§Ù„ØªØ±ÙƒÙŠØ¨</label>
  <input id="start" readonly>

  <div id="dupMsg" class="msg-err"></div>

  <button id="btnActivate" onclick="sendData()">ØªÙØ¹ÙŠÙ„ Ø§Ù„Ø¶Ù…Ø§Ù†</button>
  <div id="result" class="result"></div>
</div>

<!-- Ø§Ù„ØªØ­Ù‚Ù‚ -->
<div id="check" style="display:none">
  <button onclick="backHome()" class="bigbtn big2">â¬… Ø±Ø¬ÙˆØ¹</button>
  <h3>ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ø¶Ù…Ø§Ù†</h3>
  <input id="inv" placeholder="Ø£Ø¯Ø®Ù„ Ø±Ù‚Ù… Ø§Ù„ÙØ§ØªÙˆØ±Ø©">
  <button onclick="checkWarranty()">Ø¨Ø­Ø«</button>
  <div id="out" class="result"></div>
</div>

<!-- Ø£Ø³Ø¹Ø§Ø± Ø§Ù„Ø´Ø§Ø´Ø§Øª -->
<div id="prices" style="display:none">
  <button onclick="backHome()" class="bigbtn big2">â¬… Ø±Ø¬ÙˆØ¹</button>
  <h3>Ø£Ø³Ø¹Ø§Ø± Ø§Ù„Ø´Ø§Ø´Ø§Øª</h3>

  <div class="brands-grid">
    <div class="brand" data-brand="Redmi & Poco">Ø±ÙŠØ¯Ù…ÙŠ + Ø¨ÙˆÙƒÙˆ<small>Redmi & Poco</small></div>
    <div class="brand" data-brand="Samsung">Ø³Ø§Ù…Ø³ÙˆÙ†Ø¬<small>Samsung</small></div>
    <div class="brand" data-brand="iPhone">Ø§ÙŠÙÙˆÙ†<small>iPhone</small></div>
    <div class="brand" data-brand="Xiaomi">Ø´Ø§ÙˆÙ…ÙŠ<small>Xiaomi</small></div>
  </div>

  <input id="searchInput" placeholder="ğŸ” Ø§Ø¨Ø­Ø« Ø¹Ù† Ø§Ø³Ù… Ø§Ù„Ø´Ø§Ø´Ø© Ø£Ùˆ Ø§Ù„Ù†ÙˆØ¹">
  <div id="pricesResult"></div>
</div>

</div>

<script>
function normalizeNumber(str){
 return str?str.replace(/[Ù -Ù©]/g,d=>"Ù Ù¡Ù¢Ù£Ù¤Ù¥Ù¦Ù§Ù¨Ù©".indexOf(d)):"";
}

/* ===== Ø§Ù„ØªÙ†Ù‚Ù„ ===== */
function show(id){
 ["home","activate","check","prices"].forEach(s=>{
  let el=document.getElementById(s);
  if(el) el.style.display="none";
 });
 document.getElementById(id).style.display="block";
}
function openAct(){show("activate")}
function openChk(){show("check")}
function openPrices(){show("prices")}
function backHome(){show("home")}

document.getElementById("start").value=
 new Date().toLocaleDateString("en-GB");

/* ===== Ø£Ø³Ø¹Ø§Ø± Ø§Ù„Ø´Ø§Ø´Ø§Øª ===== */
const PRICE_SHEET =
"https://docs.google.com/spreadsheets/d/e/2PACX-1vQBLpZxNyrMjBM4164sntYUpq1f4pJxBisHgD_xh07_EvIF_-3xhfdEYp_L39DvLhAvUBQu2VPfXAh5/pub?output=csv";

let priceData=[], currentBrand="";

fetch(PRICE_SHEET).then(r=>r.text()).then(t=>{
 let rows=t.split("\n").slice(1);
 priceData=rows.map(r=>{
  let c=r.split(",");
  return {brand:c[0],name:c[1],type:c[2],notes:c[3],price:c[4],qty:c[5]};
 });
});

document.querySelectorAll(".brand").forEach(b=>{
 b.onclick=()=>{
  currentBrand=b.dataset.brand;
  renderPrices();
 };
});

document.getElementById("searchInput").oninput=renderPrices;

function renderPrices(){
 let q=document.getElementById("searchInput").value.toLowerCase();
 let out=document.getElementById("pricesResult");
 out.innerHTML="";
 priceData.filter(p=>
  p.brand.includes(currentBrand) &&
  (p.name.toLowerCase().includes(q)||p.type.toLowerCase().includes(q))
 ).forEach(p=>{
  let price=p.qty>0
    ? `<div class="price">${p.price} IQD</div>`
    : `<div class="unavailable">ØºÙŠØ± Ù…ØªÙˆÙØ±</div>`;
  out.innerHTML+=`
   <div class="price-card">
    <b>${p.name}</b><br>
    ${p.type}<br>
    ${price}
    <div>${p.notes||""}</div>
   </div>`;
 });
}
</script>

</body>
</html>
